webpackJsonp([12],{"1u2P":function(t,e){},"9+Lw":function(t,e,a){"use strict";var i=a("3cXf"),s=a.n(i),o=a("AAo7"),n=a("0xDb"),c={data:function(){return{gettingCodeTag:!1,loginData:{phone:"",smsCode:""},count:60,showCodeBox:!0,guestData:Object(n.f)()}},computed:{exitGameBox:function(){return this.$store.state.game.exitlayer.show}},methods:{preventClick:function(){return!1},closeDialog:function(){this.$emit("change",!1)},checkPhoneNum:function(){var t=!1;return this.loginData.phone?n.b.check("mobile",this.loginData.phone)?t=!0:this.$toast("手机号码格式不正确"):this.$toast("请输入手机号码"),t},getSmsCode:function(){this.checkPhoneNum()&&this.getIdentiCode()},getIdentiCode:function(){var t=this;if(!this.gettingCodeTag){this.gettingCodeTag=!0;var e={phone:this.loginData.phone,channel:$GLOBAL_CONST.channel};this.$api.decipherPost(o.a.SMSCODE,e,function(e){t.gettingCodeTag=!1,t.showCodeBox=!1;var a=t.count;!function e(){var i=setTimeout(e,1e3);t.count--,0==t.count&&(clearTimeout(i),t.showCodeBox=!0,t.count=a)}()},function(){t.gettingCodeTag=!1,t.showCodeBox=!0,t.$toast("系统君抽风，请稍候再来骚扰")})}},login:function(){var t=this;if(this.loginData.phone)if(n.b.check("mobile",this.loginData.phone))if(this.loginData.smsCode)if(n.b.check("smsCode",this.loginData.smsCode)){var e={phone:this.loginData.phone,code:this.loginData.smsCode,channel:$GLOBAL_CONST.channel};this.guestData&&(e.uid=this.guestData.uid,e.token=this.guestData.token),this.$api.decipherPost(o.a.LOGIN,e,function(e){if(0==e.status&&e.decryptData){n.a.del("TDY_GUESTDATA"),localStorage.removeItem("TDY_GUESTDATA"),n.a.set("TDY_USERINFO",s()(e.decryptData),1728e3),localStorage.setItem("TDY_USERINFO",s()(e.decryptData)),sessionStorage.setItem("TDY_SESSIONID",e.decryptData.sessionId),t.$emit("signin",e.decryptData)}else t.$toast(e.message)},function(){t.$toast("系统君抽风，请稍候再来骚扰")})}else this.$toast("验证码格式不正确");else this.$toast("请输入验证码");else this.$toast("手机号码格式不正确");else this.$toast("请输入手机号码")}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-mask-dialog mt-20",class:{"no-mask":t.exitGameBox},on:{click:function(e){return e.stopPropagation(),t.closeDialog(e)}}},[a("div",{staticClass:"common-box phone-box",on:{click:function(e){return e.stopPropagation(),t.preventClick(e)}}},[a("p",{staticClass:"title"},[t._v("登录游戏")]),t._v(" "),a("div",{staticClass:"content mt30"},[a("i",{staticClass:"icon icon-login-phone"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.loginData.phone,expression:"loginData.phone",modifiers:{trim:!0}}],staticClass:"phonenum",attrs:{maxlength:"11",type:"tel",placeholder:"请输入手机号码"},domProps:{value:t.loginData.phone},on:{input:function(e){e.target.composing||t.$set(t.loginData,"phone",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("div",{staticClass:"content mt20"},[a("i",{staticClass:"icon icon-login-sms"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.loginData.smsCode,expression:"loginData.smsCode",modifiers:{trim:!0}}],staticClass:"smscode",attrs:{maxlength:"6",type:"tel",placeholder:"请输入短信验证码"},domProps:{value:t.loginData.smsCode},on:{input:function(e){e.target.composing||t.$set(t.loginData,"smsCode",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),t.showCodeBox?a("a",{staticClass:"text",on:{click:t.getSmsCode}},[t._v("发送验证码")]):a("a",{staticClass:"text disabled"},[t._v(t._s(t.count)+"秒后重新发送")])]),t._v(" "),a("a",{staticClass:"login-btn",on:{click:function(e){return e.stopPropagation(),t.login(e)}}},[t._v("登录")])])])},staticRenderFns:[]};var l=a("vSla")(c,r,!1,function(t){a("hMef")},"data-v-32f77653",null);e.a=l.exports},Jea7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("0xDb"),s=a("AAo7"),o={data:function(){return{querysObj:{},showLoginModeDialog:!1,userData:{token:"",user:{id:""}},guestData:null,payStatus:"100",count:2,rechargePage:!1,uid:"",fromGame:""}},components:{"login-mode-dialog":a("MTC2").a},created:function(){if(this.querysObj=this.$route.query,this.uid=this.querysObj._uid||"",this.userData=Object(i.h)(),this.guestData=Object(i.f)(),this.rechargePage=this.querysObj.recharge,this.fromGame=this.querysObj.from_game,!this.querysObj.order_no)return this.payStatus="-100",void this.jumpOtherPage();"LianYun"==this.querysObj.pay_type?this.checkResultLoop():this.checkPayResult()},methods:{checkResultLoop:function(){var t=this,e=0,a=setInterval(function(){e++,t.checkOrderStatus(function(i){(1==i||e>=200)&&(clearInterval(a),t.payStatus=i,t.jumpOtherPage())})},1500)},hideModeDialog:function(){this.showLoginModeDialog=!1},jumpOtherPage:function(){var t=this,e=setInterval(function(){t.count--,0===t.count&&(e&&clearInterval(e),t.fromGame||!t.rechargePage?t.backGame():t.backToPersonal())},1e3)},backGame:function(){var t=i.a.get("TDYCURGID");if(t&&t.length){var e={_tdygid:t,channel:$GLOBAL_CONST.channel};Object(i.k)(e)}else this.backToPersonal()},handlerPhoneSign:function(t){this.userData=t,i.a.del("TDY_GUESTDATA"),localStorage.removeItem("TDY_GUESTDATA"),this.backGame()},checkPayResult:function(){var t=this,e={channel:$GLOBAL_CONST.channel,uid:this.guestData?this.guestData.uid:this.userData.user.id,token:this.guestData?this.guestData.token:this.userData.token,order_no:this.querysObj.order_no,pay_type:this.querysObj.pay_type,trade_type:this.querysObj.trade_type};this.$api.decipherPost(s.a.CHECKRESULT,e,function(e){var a=0,i=setInterval(function(){a++,t.checkOrderStatus(function(e){(1==e||a>=5)&&(clearInterval(i),t.payStatus=e,t.guestData||t.jumpOtherPage())})},1500)},function(){t.$toast("网络异常，请刷新页面重试")})},backToPersonal:function(){var t={channel:$GLOBAL_CONST.channel};this.$router.push({path:"/personal",query:t})},checkOrderStatus:function(t){var e=this,a={channel:$GLOBAL_CONST.channel,uid:this.guestData?this.guestData.uid:this.userData.user.id,token:this.guestData?this.guestData.token:this.userData.token,order_no:this.querysObj.order_no||"",id:this.querysObj.id||""};this.$api.decipherPost(this.rechargePage?s.a.FINDRECHARGEORDER:s.a.FINDPAYORDER,a,function(a){var i=null;a.decryptData&&(i=e.rechargePage?a.decryptData.order.recharge_status:a.decryptData.order.tally_status),t&&t(i)})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"result-layer"},["100"==t.payStatus?a("div",{staticClass:"pay-status-box"},[a("i",{staticClass:"icon icon-fdj"}),t._v(" "),a("p",{staticClass:"tip-text mt20"},[t._v("支付结果查询中…")])]):"-100"==t.payStatus?a("div",{staticClass:"pay-status-box"},[a("i",{staticClass:"icon icon-payerror"}),t._v(" "),a("p",{staticClass:"tip-text mt10"},[t._v("查询失败")])]):1==t.payStatus?a("div",{staticClass:"pay-status-box"},[a("i",{staticClass:"icon icon-paysuccess"}),t._v(" "),a("p",{staticClass:"tip-text mt10"},[t._v("支付成功！")]),t._v(" "),t.guestData?a("p",{staticClass:"login-tip",on:{click:function(e){t.showLoginModeDialog=!0}}},[t._v("立即登录以保存游戏进度")]):t._e()]):3==t.payStatus?a("div",{staticClass:"pay-status-box"},[a("i",{staticClass:"icon icon-payerror"}),t._v(" "),a("p",{staticClass:"tip-text mt10"},[t._v("支付锁定！")])]):a("div",{staticClass:"pay-status-box"},[a("i",{staticClass:"icon icon-payerror"}),t._v(" "),a("p",{staticClass:"tip-text mt10"},[t._v("支付失败！")])]),t._v(" "),t.rechargePage?t._e():a("a",{staticClass:"fix-bottom",on:{click:t.backGame}},[a("i",{staticClass:"icon icon-arrow-l-w"}),t._v("返回游戏")]),t._v(" "),t.showLoginModeDialog?a("div",{staticClass:"login-mode-layer"},[a("login-mode-dialog",{attrs:{responseEvent:!0},on:{hide:t.hideModeDialog,signByPhone:t.handlerPhoneSign}})],1):t._e()])},staticRenderFns:[]};var c=a("vSla")(o,n,!1,function(t){a("1u2P")},"data-v-49ac013e",null);e.default=c.exports},MTC2:function(t,e,a){"use strict";var i=a("AAo7"),s=a("0xDb"),o={components:{"phone-signin-box":a("9+Lw").a},props:["responseEvent","payByLink"],data:function(){return{isOwnClient:$GLOBAL_CONST.isOwnClient,userData:null,showPhoneDialog:!1}},mounted:function(){window.loginCallBack=this.loginCallBack},computed:{exitGameBox:function(){return this.$store.state.game.exitlayer.show}},methods:{loginCallBack:function(t,e,a){if(t&&a){var i=JSON.parse(a);s.a.del("TDY_GUESTDATA"),localStorage.removeItem("TDY_GUESTDATA"),s.a.set("TDY_USERINFO",a,1728e3),localStorage.setItem("TDY_USERINFO",a),sessionStorage.setItem("TDY_SESSIONID",i.sessionId),this.handlerSign&&this.handlerSign(i)}},closeDialog:function(){return this.responseEvent&&this.$emit("hide",!1),!1},preventClick:function(){return!1},hidePhoneDialog:function(t){this.showPhoneDialog=t},toTermPage:function(){var t=this.$route.query,e=Object(s.o)(t),a=window.location.origin+"/personal/agreement"+e;/\/pre/.test(window.location.pathname)&&(a=window.location.origin+"/pre/personal/agreement"+e),window.location.href=a},handlerSign:function(t){this.$toast({message:"登录成功，游戏加载中…",duration:1200}),this.$emit("signByPhone",t)},loginByWX:function(){window.jsInvoke.nativeLogin("wx")},loginByQQ:function(){this.isOwnClient?$GLOBAL_CONST.isOwnClientIos?this.getAuth("qq"):window.jsInvoke.nativeLogin("qq"):this.getAuth("qq")},getAuth:function(t){var e=this;this.$indicator.open();var a=""+this.$route.path,s=encodeURIComponent(a),o=window.location.href.replace(a,"/proxy_qq");-1!==o.indexOf("?")?o+="&fromPage="+s:o+="?fromPage="+s;var n={form:t,channel:$GLOBAL_CONST.channel,redirect_uri:o};this.$api.decipherPost(i.a.AUTHEXCHANGE,n,function(t){e.$indicator.close(),0==t.status?window.location.href=t.decryptData.authorize_url:e.$toast(t.message)},function(){e.$indicator.close(),e.$toast("系统君抽风，请稍候再来骚扰")})},loginByPhone:function(){this.showPhoneDialog=!0}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-mask-dialog login-dialog mt-20",class:{translucence:!t.showPhoneDialog&&!t.exitGameBox},on:{click:function(e){return e.stopPropagation(),t.closeDialog(e)}}},[a("div",{staticClass:"common-box dialog mt-20",on:{click:function(e){return e.stopPropagation(),t.preventClick(e)}}},[t._m(0),t._v(" "),a("div",{staticClass:"mode-body mt34"},[t.isOwnClient?a("a",{staticStyle:{width:"33.2%"},on:{click:t.loginByWX}},[a("i",{staticClass:"icon icon-mode-wx"}),t._v(" "),a("p",{staticClass:"mt8 font12"},[t._v("微信登录")])]):t._e(),t._v(" "),a("a",{class:{width50:!t.isOwnClient},on:{click:t.loginByQQ}},[a("i",{staticClass:"icon icon-mode-qq"}),t._v(" "),a("p",{staticClass:"mt8 font12"},[t._v("QQ登录")])]),t._v(" "),a("a",{class:{width50:!t.isOwnClient},on:{click:t.loginByPhone}},[a("i",{staticClass:"icon icon-mode-p"}),t._v(" "),a("p",{staticClass:"mt8 font12"},[t._v("手机登录")])])]),t._v(" "),a("div",{staticClass:"mode-footer mt45"},[t._v("\n        登录即代表你已经阅读并知晓"),a("span",{staticClass:"ml4",on:{click:t.toTermPage}},[t._v("用户协议")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showPhoneDialog,expression:"showPhoneDialog"}]},[a("phone-signin-box",{on:{signin:t.handlerSign,change:t.hidePhoneDialog}})],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mode-header"},[e("i",{staticClass:"mr8 fl"}),this._v(" "),e("i",{staticClass:"ml8 fr"}),this._v(" "),e("span",[this._v("选择登录方式")])])}]};var c=a("vSla")(o,n,!1,function(t){a("w1tj")},"data-v-8c00a8d4",null);e.a=c.exports},hMef:function(t,e){},w1tj:function(t,e){}});