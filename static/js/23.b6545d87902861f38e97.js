webpackJsonp([23],{jQOx:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),n=a.n(i),r=a("AAo7"),o=(a("YaEn"),a("0xDb")),s={data:function(){return{redirect_uri:"",channel:$GLOBAL_CONST.channel,guestData:Object(o.f)()}},created:function(){var e=this.$route.query,t=decodeURIComponent(e.fromPage),a=e.state,i=e.access_token;if(i){delete e.access_token,delete e.fromPage,delete e.expires_in,delete e.state,/payinfo/.test(t)&&delete e.prepay_id,/result/.test(t)&&(delete e.order_no,delete e.trade_status,delete e.pay_type,delete e.trade_type);var n=Object(o.o)(e);if(this.redirect_uri=""+window.location.origin+t+n,/\/pre/.test(window.location.pathname)&&(this.redirect_uri=window.location.origin+"/pre"+t+n),/payinfo|result/.test(t)){var r=o.a.get("TDYCURGID");t="/game/play",this.redirect_uri+=n?"&_tdygid="+r:"?_tdygid="+r}var s={channel:this.channel,code:i,state:a};this.guestData&&(s.uid=this.guestData.uid,s.token=this.guestData.token),this.loginAsync(s)}},mounted:function(){this.$indicator.open()},methods:{loginAsync:function(e){var t=this;this.$api.decipherPost(r.a.LOGINASYNC,e,function(e){if(0==e.status&&e.decryptData){var a=e.decryptData.await_id;t.loginAwait(a)}else t.$indicator.close(),t.$toast(e.message||"未知错误，请稍后重试")},function(){t.$indicator.close()})},loginAwait:function(e){var t=this,a={channel:this.channel,await_id:e},i=null,s=0,c=function(){t.$api.decipherPost(r.a.LOGINAWAIT,a,function(e){if(t.$indicator.close(),s++,0==e.status&&e.decryptData){i&&clearInterval(i);o.a.del("TDY_GUESTDATA"),localStorage.removeItem("TDY_GUESTDATA"),o.a.set("TDY_USERINFO",n()(e.decryptData),1728e3),localStorage.setItem("TDY_USERINFO",n()(e.decryptData)),sessionStorage.setItem("TDY_SESSIONID",e.decryptData.sessionId),window.location.href=t.redirect_uri}s>30&&(t.$toast("未知错误，请稍后重试"),i&&clearInterval(i))},function(){i&&clearInterval(i),t.$indicator.close()})};c(),i=setInterval(c,800)}}},c={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("QQ登录中，请稍候...")])},staticRenderFns:[]},d=a("vSla")(s,c,!1,null,null,null);t.default=d.exports}});